# Оценка Матрицы Переходных Вероятностей в Кредитно-Рейтинговой Отрасли

## О проекте
Этот проект направлен на разработку алгоритмов для оценки матрицы переходных вероятностей, используемой в кредитно-рейтинговой индустрии. Такие матрицы являются важным инструментом для анализа и прогнозирования кредитных рисков, поскольку они показывают вероятность изменения рейтинговых классов компаний или ценных бумаг за определенный временной период.

Разрабатываются и тестируются подходы на основе теории Марковских процессов, а также планируется интеграцию современных методов машинного обучения для повышения точности прогнозирования.

---

## Реализованные подходы

### 1. **Марковский процесс с дискретным временем**
Этот подход предполагает, что изменения рейтингов происходят в фиксированные временные моменты (например, раз в год или раз в квартал). 

**Основные шаги:**
1. Построение матрицы переходов на основе эмпирических данных, используя частотный метод: $P_{ij} = \frac{N_{ij}}{\sum_{k} N_{ik}}$,\
   где $N_{ij}$ — количество наблюдений переходов из состояния \(i\) в \(j\).
2. Нормализация строк матрицы для получения вероятностей переходов.
3. Валидация полученной матрицы на исторических данных.

**Преимущества:**
- Простота реализации и интерпретации.
- Подходит для анализа с фиксированными временными шагами.

**Ограничения:**
- Не учитывает временные интервалы между событиями.
- Требует больших объемов данных для построения надежной матрицы.

---

### 2. **Марковский процесс с непрерывным временем**
Подход с непрерывным временем основан на моделировании переходов рейтингов как пуассоновских процессов. Здесь используется матрица интенсивностей переходов \( Q \), которая описывает скорость переходов между состояниями.

**Основные шаги:**
1. Оценка матрицы интенсивностей \( Q \) из исторических данных, где элементы $Q_{ij}$ определяют интенсивность перехода из состояния \( i \) в \( j \).
2. Экспоненцирование матрицы интенсивностей для получения матрицы переходных вероятностей за заданный временной период \( t \): $P(t) = \exp(Qt)$

3. Калибровка \( Q \) для обеспечения точности прогнозов.

**Преимущества:**
- Учет времени между событиями.
- Подходит для анализа в условиях, где изменения рейтингов происходят неравномерно.

**Ограничения:**
- Более сложная математическая основа.
- Требует численных методов для оценки матрицы интенсивностей.

---

## Планируемые улучшения
1. **Применение методов машинного обучения:**
   - Использование методов классификации (например, логистической регрессии, случайного леса, градиентного бустинга) для прогнозирования вероятностей переходов между состояниями.
   - Анализ временных рядов и прогнозирование на основе рекуррентных нейронных сетей (RNN) и трансформеров.
   
2. **Объединение подходов:**
   - Интеграция данных с традиционных матричных методов с прогнозами моделей машинного обучения для повышения точности матриц переходных вероятностей.

3. **Моделирование зависимостей:**
   - Анализ зависимости рейтингов от макроэкономических показателей и других факторов.

---

## Структура репозитория
- `data/`: Исходные данные для построения матриц.
- `notebooks/`: Jupyter-ноутбуки с анализом данных и визуализациями.
- `models/`: Реализация алгоритмов оценки матриц переходных вероятностей.
- `docs/`: Дополнительная документация по методам и метрикам.
- `scripts/`: Автоматизация процессов калибровки и тестирования моделей.

---

## Установка и запуск
1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Ознакомьтесь с результатами в папке `results/`.

---